---
title: Что такое интерпретатор?
# subtitle:
description: Зачем нужны интерпретаторы? Причины появления интерпретаторов. Как устроены интерпретаторы? На эти вопросы поможет ответить этот гайд.
# image: "assets/images/compiler/compiler.jpg"
author: Марк Шевченко
---

В этом гайде мы узнаем, что такое интерпретатор, для чего он нужен, и как работает. Этот материал поможет вам разобраться, как компьютер выполняет ваши программы.

## Зачем нужен интерпретатор

В переводе с английского языка компьютер означает *вычислитель*. Мы привыкли к тому, что компьютер помогает нам готовить документы, читать новости и смотреть ролики. Нам редко приходится что-то вычислять, поэтому такое название кажется странным.

Вместе с тем это название очень точно отражает природу компьютера. Мы этого не видим, но на самом деле компьютер умеет работать только с числами. И документы, и новости, и ролики выглядят для компьютера как наборы чисел.

Также выглядят для него и программы, которые он выполняет.

Каждая команда имеет свой числовой — машинный — код, так что компьютер без труда понимает, что нужно делать. Человеку трудно писать программы в машинных кодах. На заре компьютерной эры первые программисты кодировали программы вручную и, естественно, хотели облегчить свою работу.

Пример программы в машинных кодах:

```
102 184 0 0
102 185 100 0
102 1 200
102 73
102 131 249 0
117 245
```

<!--
https://defuse.ca/online-x86-assembler.htm

0:  66 b8 00 00             mov    ax,0x0
4:  66 b9 64 00             mov    cx,100
00000008 <loop>:
8:  66 01 c8                add    ax,cx
b:  66 49                   dec    cx
d:  66 83 f9 00             cmp    cx,0
11: 75 f5     
-->

Они придумали языки программирования, которые очень похожи на человеческие. Писать программы на таком языке гораздо проще, потому что он понятен человеку. Но тут есть одна сложность: если компьютер понимает команды только в виде чисел, как он будет выполнять команды, написанные на языке программирования?

Есть два вида программ, которые помогают решить эту проблему — *интерпретаторы* и *компиляторы*. На нашем ресурсе есть [статья, которая подробно рассказывает о компиляторах](/compiler/).

В этой же статье мы поговорим об интерпретаторах. Что это такое? Вкратце, 
*интерпретатор* — это программа, которая выполняет команды, написанные на каком-то языке программирования.

Интерпретатор Python понимает команды языка Python, а интерпретатор JavaScript — команды языка JavaScript.

## Экскурс в историю

Самый первый интерпретатор был разработан в 1958 году для языка программирования Lisp. Как вы думаете, на чём он был написан?

Поскольку интерпретаторов тогда не было, его пришлось писать в машинных кодах.

Lisp дожил до наших дней — популярный редактор Emacs написан на одной из современных версий этого языка.

Разные программисты иногда разрабатывают разные интерпретаторы языка, которые немного отличаются друг от друга. 
Такие версии языка называют его *диалектами*. Помимо Emacs Lisp вы могли слышать о таком диалекте Lisp, как ClojureScript. Его иногда используют вместо JavaScript при разработке фронтенда.

Вот небольшой пример программы на языке Lisp.

```lisp
(defun sum (n)
    (if (= n 0)
        0
        (+ n (sum (- n 1)))))

(sum 100)
```

Даже не зная Lisp, мы видим, что в программе есть структура и что какие-то части программы мы можем даже понять.

Доступность для понимания — выгодное преимущество языков программирования перед машинным кодом.

Есть интерпретаторы для таких популярных языков программирования, как Python и JavaScript. Они хорошо подходят не только для работы, но и для того, чтобы изучать программирование. Немаловажную роль в этом играет то, что для них существует интерпретаторы, и чуть позже мы узнаем, почему это так.

## Пример интерпретатора Python

Для того, чтобы показать работу интерпретатора, нам потребуется написать небольшую и не очень сложную программу. Пусть это будет вычисление суммы чисел от 1 до 100.

```python
sum = 0
for i in range(1, 101):
  sum = sum + i
print(sum) # => 5050
```

Запустим интерпретатор *python* и построчно введём программу.

![Пример работы интерпретатора Python](/assets/images/interpreter/example.png)

Мы видим, что начале каждой строки интерпретатор выводит подсказку `>>>`. Когда мы вводим команду `for`, состоящую из двух строк, подсказка меняется на троеточие `...`.

Выполняя команду `print(sum)`, интерпретатор печатает результат — число 5050.

Если мы допустим ошибку, интерпретатор подскажет нам, где находится ошибка.

![Пример ошибки в программе](/assets/images/interpreter/error.png)

В этом примере мы забыли поставить двоеточие после инструкции `for`.

Немедленный отклик интерпретатора очень важен при изучении языка. Новички, видя сообщениях об ошибках и пробуя разные варианты, быстро осваивают незнакомый синтаксис. Именно поэтому такие языки, как Python и JavaScript, часто используют для обучения.

Опытные программисты также ценят такой — *интерактивный* — способ разработки, потому что он помогает быстро проверять свои идеи.

Так что интерпретируемые языки часто используют, чтобы разрабатывать прототипы больших программ.

Интерпретатор в интерактивном режиме постоянно выполняет одни и те же действия. Он читает команду программиста, выполняет её и, наконец, печатает результат. Такой режим называют *Циклом Чтения-Выполнения-Печати*, или, по-английски *Read-Evaluate-Print Loop*. Обычно это название сокращают до аббревиатуры REPL.

![Цикл Чтения-Выполнения-Печати](/assets/images/interpreter/repl.png)

## Пример интерпретатора JavaScript

Интерпретатор JavaScript встроен прямо в наш браузер. Посмотрим, как он работает, на примере браузера Chrome.

В правом верхнем углу есть три вертикальные точки, которые вызывают меню браузера. Нажмите и выберите пункт меню *Дополнительные инструменты*, а затем *Инструменты разработчика*.

![Инструменты разработчика Chrome](/assets/images/interpreter/chrome-dev-tools.png)

Вы увидите новое окно в браузере, плотно заполненное вкладками. Всё это полезные инструменты, которые вам предстоит освоить. Но сейчас нам нужна одна вкладка — *Console*. В консоли мы можем набирать команды языка JavaScript и сразу видеть отклик интерпретатора.

```javascript
a = 1; // => 1
b = 2; // => 2
3 * (a + b); // => 9
```

Интерпретатор сохранит переменные `a` и `b` со значениями 1 и 2, затем вычислит значение `3 * (a + b)` и напечатает результат 9.

![Консоль Chrome](/assets/images/interpreter/chrome-console.png)

## Выполнение программы

Цикл чтения-выполнения-печати помогает разрабатывать программу, но, в конечном итоге мы не хотим каждый раз вводить наши команды.

Мы хотим ввести их один раз и потом просто запускать готовую программу. Создадим текстовый файл *sum<span>.</span>py* и запишем там наши команды:

```python
sum = 0

for i in range(1, 101):
  sum = sum + i

print(sum)
```

Чтобы её выполнить, достаточно запустить интерпретатор Python, указав имя файла в параметрах:

```
> python sum.py
5050
```

Интерпретатор выполняет команды одну за одной и в конце завершает свою работу. Такой режим работы интерпретатора называют *пакетным*.

Таким образом, интерпретатор может работать в двух режимах. Интерактивный режим (REPL) помогает нам проверять идеи и придумывать решение задач. Пакетный режим выполняет готовую программу.

## Устройство интерпретатора

Есть много способов написать интерпретатор. Мы не будем рассматривать все возможные варианты, а расскажем об устройстве интерпретаторов в целом. Обычный язык программирования содержит несколько десятков команд. В программе на Python, которую мы обсуждали выше есть операторы присваивания, цикл `for` и вызов функции `print`. Всё это — команды, которые понимает интерпретатор Python.

Для каждой команды в интерпретаторе есть блок кода, который умеет такую команду исполнять.
Вторая важная составляющая интерпретатора — анализатор текста. Когда программист вводит текст, анализатор разбирает его на составные части, и понимает, о какой команде идёт речь. После этого он передаёт управление блоку, отвечающему за выполнение этой команды.

Так — в цикле — интерпретатор и работает. Анализирует введённую команду, затем выполняет, снова анализирует, и снова выполняет. Анализ текста это, конечно, не тривиальная задача, но и не слишком трудная, так что интерпретаторы в действительности не такие уж и сложные программы.

![Как работает интерпретатор](/assets/images/interpreter/how-it-works.png)

## Достоинства и недостатки

Достоинства интерпретаторов:

* **Простота изучения.** REPL помогает проверять, как работают незнакомые конструкции и быстро осваивать синтаксис языка.

* **Простота программирования.** Как и  компилятор, интерпретатор избавляет нас от необходимости писать программы в машинных кодах.

* **Кроссплатформенность.** Интепретаторы разрабатаны для разных платформ — Mac, Windows, Linux, поэтому написанная нами программа будет работать на всех платформах.

* **Улучшение программы за счёт интерпретатора.** Скорость программ зависит не только от нас, но и от того, насколько быстро работает интерпретатор. Мы знаем, что программисты Google постоянно улучшают интерпретатор JavaScript, который работает в браузере Chrome. Если мы написали программу на JavaScript, с каждой новой версией Chrome она работает быстрее, даже если мы ничего в ней не улучшаем.

Недостатки интерпретаторов:

* **Низкая скорость.** Интерпретируемые программы работают медленнее, чем программы в машинных кодах. Это происходит потому, что интерпретатор должен сначала проанализировать текст команды, и лишь потом её выполнить. Программа же в машинных кодах сразу понятна компьютеру.

* **Зависимость от интерпретатора.** Интерпретируемой программе нужен интерпретатор. В Windows программы в машинных кодах имеют расширение *.exe*. Такую программу, скажем, архиватор 7-zip можно просто запустить. А для того, чтобы выполнить программу на языке Python, нужен интерпретатор *python*.

* **Доступность исходного кода.** Исходный код на интерпретируемом языке доступен пользователю программы. Пользователь может подсмотреть в программе то, что её автор хотел бы скрыть, например, способ шифрования пароля или уникальный алгоритм.

* **Позднее обнаружение ошибок.** Интепретаторы выполняют программы по одной команде. Если в синтаксисе команды допущена ошибка, интепретатор не сможет об этом узнать, пока не приступит к её анализу. В больших программах есть куски, которые выполняются реже других и, возможно, там есть ошибки, про которые программист не знает. Чтобы избежать ошибок, которые увидит пользователь программы, приходится тестировать её гораздо тщательней.

## Выводы и рекомендации

Интерпретатор языка программирования — это программа, выполняющая команды, написанные на этом языке. Мы, например, говорим *интерпретатор Python* или *интерпретатор JavaScript*.

Интерактивный режим (REPL) помогает программистам изучать синтаксис языка и проверять свои идеи.

Интерпретатор состоит из анализатора текста и исполнителей отдельных команд языка, таких как цикл `for`, проверка `if`, вызов функции `print`, и других.

К достоинствам интерпретируемых языков относят простоту изучения. Именно поэтому программирование начинают изучать с таких языков, как Python и JavaScript.
